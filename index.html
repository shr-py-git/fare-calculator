<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>FairRoute ‚Äì Transparent Fare Estimator</title>

  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>

  <style>
    /* ===========================
   GLOBAL THEME
=========================== */
:root {
  --primary: #1f4fd8;        /* corporate blue */
  --primary-dark: #153a9e;
  --bg-light: #f4f6f9;
  --bg-card: #ffffff;
  --border: #d9dee8;
  --text-main: #1f2937;
  --text-muted: #6b7280;
}

body {
  font-family: "Inter", "Segoe UI", system-ui, sans-serif;
  max-width: 780px;
  margin: 24px auto;
  padding: 16px;
  background: var(--bg-light);
  color: var(--text-main);
  animation: pageFade 0.6s ease;
}

@keyframes pageFade {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* ===========================
   HEADER
=========================== */
h2 {
  text-align: center;
  font-size: 26px;
  font-weight: 600;
  margin-bottom: 14px;
  color: var(--primary-dark);
  animation: slideDown 0.6s ease;
}
    .title {
  text-align: center;
  margin-bottom: 18px;
}

.title .brand {
  display: block;
  font-size: 38px;
  font-weight: 700;
  color: var(--primary-dark);
  letter-spacing: 1px;
}

.title .tagline {
  display: block;
  margin-top: 6px;
  font-size: 15px;
  font-weight: 400;
  color: var(--text-muted);
}


@keyframes slideDown {
  from { opacity: 0; transform: translateY(-12px); }
  to { opacity: 1; transform: translateY(0); }
}

/* ===========================
   INPUTS & SELECT
=========================== */
input, select {
  width: 100%;
  padding: 12px 14px;
  margin-top: 14px;
  font-size: 15px;
  border-radius: 8px;
  border: 1px solid var(--border);
  background: var(--bg-card);
  transition: border 0.25s ease, box-shadow 0.25s ease;
}

input::placeholder {
  color: var(--text-muted);
}

input:focus, select:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(31,79,216,0.15);
  outline: none;
}

/* ===========================
   AUTOCOMPLETE
=========================== */
ul {
  list-style: none;
  padding: 0;
  margin-top: 6px;
  background: var(--bg-card);
  border-radius: 8px;
  border: 1px solid var(--border);
  max-height: 180px;
  overflow-y: auto;
  animation: fadeUp 0.3s ease;
}

@keyframes fadeUp {
  from { opacity: 0; transform: translateY(6px); }
  to { opacity: 1; transform: translateY(0); }
}

li {
  padding: 10px 14px;
  font-size: 14px;
  cursor: pointer;
  transition: background 0.2s ease;
}

li:hover {
  background: #eef2ff;
}

/* ===========================
   BUTTON
=========================== */
button {
  width: 100%;
  margin-top: 22px;
  padding: 14px;
  font-size: 16px;
  font-weight: 600;
  border-radius: 10px;
  border: none;
  background: var(--primary);
  color: white;
  cursor: pointer;
  transition: background 0.25s ease, box-shadow 0.25s ease;
}

button:hover {
  background: var(--primary-dark);
  box-shadow: 0 10px 18px rgba(31,79,216,0.25);
}

button:active {
  transform: scale(0.98);
}

/* ===========================
   MAP
=========================== */
#map {
  height: 360px;
  margin-top: 24px;
  border-radius: 14px;
  border: 1px solid var(--border);
  box-shadow: 0 10px 25px rgba(0,0,0,0.08);
  animation: mapFade 0.8s ease;
}

@keyframes mapFade {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* ===========================
   RESULTS & FARE CARDS
=========================== */
#result {
  margin-top: 24px;
  animation: fadeUp 0.5s ease;
}

.fare-box {
  background: var(--bg-card);
  border-radius: 12px;
  padding: 14px 16px;
  margin-top: 12px;
  border-left: 5px solid var(--primary);
  box-shadow: 0 8px 18px rgba(0,0,0,0.06);
  transition: transform 0.25s ease, box-shadow 0.25s ease;
}

.fare-box:hover {
  transform: translateY(-3px);
  box-shadow: 0 14px 28px rgba(0,0,0,0.1);
}

/* ===========================
   FOOTER NOTE
=========================== */
small {
  display: block;
  margin-top: 16px;
  text-align: center;
  font-size: 13px;
  color: var(--text-muted);
  animation: fadeUp 0.6s ease;
}

/* ===========================
   MOBILE
=========================== */
@media (max-width: 600px) {
  h2 {
    font-size: 22px;
  }

  button {
    font-size: 15px;
  }
    .title .brand {
    font-size: 30px;
  }

}

  </style>
</head>
<body>

<h2 class="title">
  <span class="brand" id="brand">FairRoute</span>
  <span class="tagline" id="tagline">Transparent Fare Estimator</span>
</h2>


<select onchange="setLanguage(this.value)">
  <option value="en">English</option>
  <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
  <option value="es">Espa√±ol</option>
  <option value="fr">Fran√ßais</option>
</select>

<input id="from" placeholder="Pickup location" oninput="debouncedSuggest(this,'fromList')">
<ul id="fromList"></ul>

<input id="to" placeholder="Drop location" oninput="debouncedSuggest(this,'toList')">
<ul id="toList"></ul>

<button onclick="calculate()" id="calcBtn">Calculate</button>

<div id="map"></div>
<div id="result"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
/* ---------- LANGUAGE DATA ---------- */
let currentLang = "en";

const lang = {
  en: {
    title: "FairRoute ‚Äì Transparent Fare Estimator",
    calc: "Calculate",
    enter: "Enter both locations.",
    calcTxt: "Calculating...",
    error: "Error calculating route.",
    distance: "Distance",
    pickup: "Pickup",
    drop: "Drop",
    estimate: "Estimated fair range"
  },
  hi: {
    title: "‡§´‡•á‡§Ø‡§∞‡§∞‡•Ç‡§ü ‚Äì ‡§™‡§æ‡§∞‡§¶‡§∞‡•ç‡§∂‡•Ä ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ ‡§Ö‡§®‡•Å‡§Æ‡§æ‡§®",
    calc: "‡§ó‡§£‡§®‡§æ ‡§ï‡§∞‡•á‡§Ç",
    enter: "‡§ï‡•É‡§™‡§Ø‡§æ ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§∏‡•ç‡§•‡§æ‡§® ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç‡•§",
    calcTxt: "‡§ó‡§£‡§®‡§æ ‡§ï‡•Ä ‡§ú‡§æ ‡§∞‡§π‡•Ä ‡§π‡•à...",
    error: "‡§Æ‡§æ‡§∞‡•ç‡§ó ‡§ï‡•Ä ‡§ó‡§£‡§®‡§æ ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø‡•§",
    distance: "‡§¶‡•Ç‡§∞‡•Ä",
    pickup: "‡§™‡§ø‡§ï‡§Ö‡§™",
    drop: "‡§°‡•ç‡§∞‡•â‡§™",
    estimate: "‡§Ö‡§®‡•Å‡§Æ‡§æ‡§®‡§ø‡§§ ‡§â‡§ö‡§ø‡§§ ‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ"
  },
  es: {
    title: "FairRoute ‚Äì Estimador de tarifas",
    calc: "Calcular",
    enter: "Ingrese ambas ubicaciones.",
    calcTxt: "Calculando...",
    error: "Error al calcular la ruta.",
    distance: "Distancia",
    pickup: "Recogida",
    drop: "Destino",
    estimate: "Rango de tarifa justa"
  },
  fr: {
    title: "FairRoute ‚Äì Estimation de tarif",
    calc: "Calculer",
    enter: "Veuillez entrer les deux lieux.",
    calcTxt: "Calcul en cours...",
    error: "Erreur de calcul de l'itin√©raire.",
    distance: "Distance",
    pickup: "D√©part",
    drop: "Arriv√©e",
    estimate: "Fourchette de prix √©quitable"
  }
};

function t(key) {
  return lang[currentLang][key];
}

function setLanguage(l) {
  currentLang = l;

  // Keep brand name fixed
  document.getElementById("brand").innerText = "FairRoute";

  // Update only subtitle
  const fullTitle = t("title");
  const parts = fullTitle.split("‚Äì");
  document.getElementById("tagline").innerText =
    parts.length > 1 ? parts[1].trim() : fullTitle;

  document.getElementById("calcBtn").innerText = t("calc");
}


/* ---------- MAP INIT ---------- */
let map = L.map("map").setView([20.5937, 78.9629], 5);
L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map);

let pickupMarker, dropMarker, routeLine;
let debounceTimer;

/* ---------- AUTOCOMPLETE ---------- */
function debouncedSuggest(input, listId) {
  clearTimeout(debounceTimer);
  debounceTimer = setTimeout(() => suggest(input, listId), 300);
}

async function suggest(input, listId) {
  if (input.value.length < 3) return;
  const res = await fetch(
    `https://nominatim.openstreetmap.org/search?format=json&limit=10&countrycodes=in&q=${encodeURIComponent(input.value)}`
  );
  const data = await res.json();
  const list = document.getElementById(listId);
  list.innerHTML = "";
  data.forEach(p => {
    const li = document.createElement("li");
    li.textContent = p.display_name;
    li.onclick = () => { input.value = p.display_name; list.innerHTML = ""; };
    list.appendChild(li);
  });
}

/* ---------- GEO + DISTANCE ---------- */
async function geocode(place) {
  const r = await fetch(
    `https://nominatim.openstreetmap.org/search?format=json&limit=1&countrycodes=in&q=${encodeURIComponent(place)}`
  );
  const d = await r.json();
  return { lat: +d[0].lat, lng: +d[0].lon };
}

function haversine(a,b,c,d) {
  const R=6371;
  const dLat=(c-a)*Math.PI/180;
  const dLon=(d-b)*Math.PI/180;
  const x=Math.sin(dLat/2)**2+
  Math.cos(a*Math.PI/180)*Math.cos(c*Math.PI/180)*Math.sin(dLon/2)**2;
  return R*2*Math.atan2(Math.sqrt(x),Math.sqrt(1-x));
}

/* ---------- FARE ---------- */
function estimateFare(km){
  return {
    bike:[20+km*7,30+km*10],
    auto:[30+km*12,40+km*18],
    cab:[50+km*18,70+km*25]
  };
}

/* ---------- MAIN ---------- */
async function calculate() {
  const f=document.getElementById("from").value;
  const t1=document.getElementById("to").value;
  const r=document.getElementById("result");

  if(!f||!t1){ r.innerText=t("enter"); return; }

  r.innerText=t("calcTxt");

  try{
    const s=await geocode(f), e=await geocode(t1);
    const km=haversine(s.lat,s.lng,e.lat,e.lng);
    const fare=estimateFare(km);

    // Local Auto: 1/3 of Auto fare
    const localAutoMin = (fare.auto[0]/3).toFixed(0);
    const localAutoMax = (fare.auto[1]/3).toFixed(0);

    if(pickupMarker) map.removeLayer(pickupMarker);
    if(dropMarker) map.removeLayer(dropMarker);
    if(routeLine) map.removeLayer(routeLine);

    pickupMarker=L.marker([s.lat,s.lng]).addTo(map).bindPopup(t("pickup"));
    dropMarker=L.marker([e.lat,e.lng]).addTo(map).bindPopup(t("drop"));
    routeLine=L.polyline([[s.lat,s.lng],[e.lat,e.lng]]).addTo(map);
    map.fitBounds(routeLine.getBounds());

    r.innerHTML=`
      <b>${t("distance")}:</b> ${km.toFixed(2)} km
      <div class="fare-box">üö≤ Bike: ‚Çπ${fare.bike[0]|0} ‚Äì ‚Çπ${fare.bike[1]|0}</div>
      <div class="fare-box">üõ∫ Auto: ‚Çπ${fare.auto[0]|0} ‚Äì ‚Çπ${fare.auto[1]|0}</div>
      <div class="fare-box">üõ∫ Local Auto: ‚Çπ${localAutoMin} ‚Äì ‚Çπ${localAutoMax}</div>
      <div class="fare-box">üöï Cab: ‚Çπ${fare.cab[0]|0} ‚Äì ‚Çπ${fare.cab[1]|0}</div>
      <small>*${t("estimate")}</small>
    `;
  } catch {
    r.innerText=t("error");
  }
}
</script>

</body>
</html>
